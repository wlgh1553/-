#include "main.h"
#include "menu.h"
#include"game.h"
int pass_map_arr[5] = { 0, };

int main()
{
	intro_animation_total();

	int is_bgm_on = 1;

	while (1) {

		int order = menu_main(&is_bgm_on);
		if (order == -1) {
			system("cls");
			gotoxy(8, 13);
			printf("종료를 원한다면 아무 키나 다시 입력해주세요.");
			ColorSet(0, 0);
			return 0;
		}
		system("cls");

		int map_check, map_num;
		int check_all_pass = 0;
		map_check = map_sel_Draw();

		if (map_check == 5)
		{
			system("cls");
			order = menu_main(&is_bgm_on);
			if (order == -1) {
				system("cls");
				gotoxy(8, 13);
				printf("종료를 원한다면 아무 키나 다시 입력해주세요.");
				ColorSet(0, 0);
				return 0;
			}
			system("cls");
			map_check = map_sel_Draw();
		}


		if (map_check == 1)  //학정6층
		{
			//310
			int frameArr[frameArrsizei][frameArrsizej] = {
			   {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
			   {1,2,0,0,1,0,0,0,4,1,0,0,0,0,1,4,0,0,0,0,5,1,0,4,1},
			   {1,0,1,1,1,0,1,1,1,1,0,0,1,1,1,0,1,0,0,0,0,1,0,0,1},
			   {1,0,1,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,1,1,0,1,0,0,1},
			   {1,4,1,0,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,1},
			   {1,0,0,0,1,0,0,1,9,0,0,4,0,1,1,1,1,1,0,0,0,1,1,0,1},
			   {1,1,1,1,1,0,0,1,4,6,6,0,0,1,10,0,0,1,1,1,0,1,0,0,1},
			   {1,0,0,0,0,0,5,1,0,0,1,1,1,0,5,1,1,1,0,0,0,1,0,1,1},
			   {1,4,0,1,0,0,0,0,0,1,0,4,1,0,0,9,0,0,0,0,1,1,0,0,1},
			   {1,1,1,1,0,0,1,0,0,1,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1},
			   {1,0,0,0,0,1,1,1,1,1,0,0,1,0,0,9,1,0,0,0,0,0,0,1,1},
			   {1,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,0,1,1,1,1,1},
			   {1,1,1,1,1,1,0,1,0,1,0,0,0,1,1,4,1,0,1,0,5,0,0,0,1},
			   {1,1,0,0,0,0,0,1,0,1,0,1,9,1,3,0,1,0,1,0,0,1,0,0,1},
			   {1,0,0,1,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1},
			   {1,0,1,1,5,0,0,1,0,0,0,4,0,0,1,1,1,1,1,0,0,1,1,1,1},
			   {1,0,0,1,0,1,1,1,1,1,0,1,0,0,1,0,0,0,1,0,0,1,0,1,1},
			   {1,4,0,1,0,1,4,0,0,0,0,1,0,0,1,4,0,0,8,0,0,0,0,4,1},
			   {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
			};
			map_num = 1;
			int TimeLimit = 150;
			int extLimit = 5;
			int exit_player1_X = 14;
			int exit_player1_Y = 13;
			int exit_player2_X = 14;
			int exit_player2_Y = 6;
			int exit_player3_X = 0;   //도착지점이 2개인 맵은 exit_player3_Y변수를 0으로 설정하고 시작함
			int exit_player3_Y = 0;   //도착지점이 3개인 맵에서 exit_player3_Y = 0인 경우는 없어서 이렇게 설정한거임
			Ready_Map(map_num);
			GameStart_Map1(frameArr, TimeLimit, extLimit, exit_player1_X, exit_player1_Y, exit_player2_X, exit_player2_Y,
				exit_player3_X, exit_player3_Y, map_num);

			//함수 돌 때 exit_player3_Y == 0이면 도착지점이 2개인 걸로 인식?하고 진행하게 만든거야!
		}

		else if (map_check == 2)  //대양ai
		{
			int frameArr[frameArrsizei][frameArrsizej] = {
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,2,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1},
				{1,8,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1},
				{1,1,1,1,1,1,1,1,1,1,1,1,5,1,1,1,1,1,1,0,1,0,1,0,1},
				{1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,1,1,1,0,1,0,1,1,1},
				{1,0,0,0,1,9,1,1,1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,1},
				{1,0,0,0,1,0,0,0,0,0,6,1,0,6,6,1,0,0,1,1,1,1,1,0,1},
				{1,1,1,1,1,0,0,6,6,6,4,0,0,6,6,1,0,0,4,0,4,0,1,0,1},
				{1,11,0,0,0,0,0,0,0,0,0,0,0,6,6,1,0,0,1,0,1,0,0,0,1},
				{1,1,1,1,0,5,0,0,6,6,6,0,0,6,6,1,0,0,1,0,0,0,1,1,1},
				{1,0,4,1,4,0,0,6,0,0,0,0,0,6,6,1,5,0,0,0,1,0,0,0,1},
				{1,0,1,0,1,0,0,0,0,0,0,0,1,0,0,4,1,1,1,0,1,1,1,1,1},
				{1,0,1,0,1,0,1,1,9,1,1,0,1,0,0,0,0,0,0,0,0,4,0,11,1},
				{1,0,0,0,0,0,1,0,1,0,1,5,0,0,1,0,1,1,1,1,9,1,0,0,1},
				{1,0,1,1,0,0,1,0,1,0,1,1,0,1,1,0,0,0,1,0,0,1,0,1,1},
				{1,0,1,0,0,0,0,0,1,0,1,0,0,4,1,0,1,0,1,0,0,1,0,0,1},
				{1,0,1,1,1,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,0,1,0,1,1},
				{1,0,1,0,0,0,0,0,0,0,1,0,11,0,1,0,1,0,0,1,0,1,0,0,1},
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
			};
			map_num = 2;
			int TimeLimit = 150;
			int extLimit = 5;
			int exit_player1_X = 1;
			int exit_player1_Y = 8;
			int exit_player2_X = 12;
			int exit_player2_Y = 17;
			int exit_player3_X = 23;  //도착지점이 3개면 그대로 출구 설정하고 시작
			int exit_player3_Y = 12;
			Ready_Map(map_num);
			GameStart_Map2(frameArr, TimeLimit, extLimit, exit_player1_X, exit_player1_Y, exit_player2_X, exit_player2_Y,
				exit_player3_X, exit_player3_Y, map_num);
		}

		else if (map_check == 3)  //광토 지하
		{
			int frameArr[frameArrsizei][frameArrsizej] = {
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,2,0,1,0,5,0,1,0,0,0,1,4,0,0,1,1,1,1,4,0,0,1,10,1},
				{1,0,0,1,0,1,0,1,0,1,1,1,0,0,0,0,0,0,1,0,0,0,1,0,1},
				{1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,1},
				{1,0,0,0,4,1,0,1,1,1,1,1,1,0,0,1,1,1,1,0,1,1,1,1,1},
				{1,5,1,1,1,1,0,1,0,0,5,0,0,0,0,0,0,0,1,0,1,5,0,0,1},
				{1,0,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,1},
				{1,0,1,5,1,0,0,0,0,1,0,0,1,5,0,0,0,0,0,0,0,0,0,0,1},
				{1,0,1,1,1,0,0,1,0,1,0,0,1,0,0,0,0,0,0,5,0,0,0,4,1},
				{1,9,0,0,0,0,0,1,0,1,0,0,1,0,1,1,1,1,5,5,5,1,1,1,1},
				{1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,6,6,6,1},
				{1,0,0,0,0,0,0,5,5,1,1,1,1,0,1,1,1,0,1,0,0,0,0,0,1},
				{1,0,0,0,0,0,0,0,0,1,0,4,0,1,1,4,1,0,1,4,0,6,6,6,1},
				{1,0,0,0,1,1,1,1,0,1,0,0,0,1,0,0,1,0,1,0,0,1,1,1,1},
				{1,0,0,5,1,4,0,1,3,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,1},
				{1,0,1,1,1,0,0,1,0,0,0,1,1,1,0,1,0,0,0,0,0,1,1,1,1},
				{1,0,1,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,5,1,0,1,0,0,1},
				{1,9,0,0,0,0,0,0,0,0,0,1,9,1,0,6,6,6,6,1,9,0,0,8,1},
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
			};
			map_num = 3;
			int TimeLimit = 150;
			int extLimit = 5;
			int exit_player1_X = 8;
			int exit_player1_Y = 14;
			int exit_player2_X = 23;
			int exit_player2_Y = 1;
			int exit_player3_X = 0;
			int exit_player3_Y = 0;
			Ready_Map(map_num);
			GameStart_Map3(frameArr, TimeLimit, extLimit, exit_player1_X, exit_player1_Y, exit_player2_X, exit_player2_Y,
				exit_player3_X, exit_player3_Y, map_num);
		}

		else if (map_check == 4)  //대양홀
		{
			int frameArr[frameArrsizei][frameArrsizej] = {
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,0,0,0,0,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,0,0,0,0,4,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1},
				{11,0,0,1,6,0,0,0,5,0,0,1,1,0,1,6,6,6,0,0,1,1,1,1,1},
				{1,0,0,0,6,0,1,1,1,0,4,1,6,0,0,0,0,0,0,0,0,0,0,0,1},//끝
				{1,0,0,0,0,0,1,1,1,1,0,0,6,0,4,1,1,1,0,0,0,0,0,1,1},
				{1,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,1,1},
				{1,0,0,1,1,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,1,1},
				{11,0,0,1,1,0,4,1,1,1,0,0,5,0,0,0,0,0,0,0,0,0,0,1,1},
				{1,0,0,1,1,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,1,1},
				{1,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,8,1,1},
				{1,0,0,0,0,0,1,1,1,1,0,0,6,0,4,1,1,1,0,0,0,0,0,1,1},
				{1,0,0,0,6,0,1,1,1,0,4,1,6,0,0,0,0,0,0,0,0,0,0,0,1},//끝
				{11,0,0,1,6,0,0,0,5,0,0,1,1,0,1,6,6,6,0,0,1,1,1,1,1},
				{1,0,0,1,1,5,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1},
				{1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,0,0,0,0,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
				{1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
			};
			map_num = 4;
			int TimeLimit = 150;
			int extLimit = 5;
			int exit_player1_X = 0;
			int exit_player1_Y = 4;
			int exit_player2_X = 0;
			int exit_player2_Y = 9;
			int exit_player3_X = 0;
			int exit_player3_Y = 14;
			Ready_Map(map_num);
			GameStart_Map4(frameArr, TimeLimit, extLimit, exit_player1_X, exit_player1_Y, exit_player2_X, exit_player2_Y,
				exit_player3_X, exit_player3_Y, map_num);
		}
		Sleep(1500);
		ColorSet(0, 7);
		system("cls");



		for (int i = 0; i < 5; i++)
		{
			if (pass_map_arr[i] == 1)
			{
				check_all_pass++;
			}
		}
		if (check_all_pass == 4) {
			print_all_pass();
			Sleep(2000);
			system("cls");
			gotoxy(8, 13);
			ColorSet(0, 7);
			printf("종료를 원한다면 아무 키나 다시 입력해주세요.");
			ColorSet(0, 0);
			return 0;
		}

	}

	return 0;
}